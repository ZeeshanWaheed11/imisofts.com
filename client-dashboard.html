<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Client Workspace | imisofts</title>

  <!-- Visitor Tracking -->
  <script id="vtag-ai-js" async src="https://r2.leadsy.ai/tag.js" data-pid="Sfy91D1xWAFhfQuk" data-version="062024"></script>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">

  <style>
    :root {
      --sidebar-bg: #0f172a;
      --sidebar-border: rgba(255, 255, 255, 0.08);
      --primary: #2563eb;
      --primary-soft: #edf2ff;
      --surface: #ffffff;
      --surface-alt: #f8fafc;
      --border: #e2e8f0;
      --text-strong: #0f172a;
      --text-subtle: #475569;
      --radius-lg: 18px;
      --radius-md: 14px;
      --shadow-soft: 0 24px 60px rgba(15, 23, 42, 0.08);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background: linear-gradient(180deg, #f1f5f9 0%, #f8fafc 100%);
      min-height: 100vh;
      color: var(--text-strong);
    }

    a { color: inherit; text-decoration: none; }

    .dashboard-shell {
      min-height: 100vh;
      display: grid;
      grid-template-columns: 280px minmax(0, 1fr);
    }

    .sidebar {
      background: var(--sidebar-bg);
      color: rgba(226, 232, 240, 0.92);
      padding: 32px 28px;
      display: flex;
      flex-direction: column;
      gap: 32px;
      position: sticky;
      top: 0;
      height: 100vh;
      border-right: 1px solid var(--sidebar-border);
    }

    .sidebar-brand {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .brand-logo {
      width: 46px;
      height: 46px;
      border-radius: 14px;
      background: rgba(59, 130, 246, 0.18);
      color: #60a5fa;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .brand-name {
      font-size: 18px;
      font-weight: 500;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .brand-tagline {
      font-size: 12px;
      color: rgba(226, 232, 240, 0.6);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      margin-top: 4px;
    }

    .sidebar-user-card {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid var(--sidebar-border);
      border-radius: var(--radius-md);
      padding: 18px;
      display: flex;
      gap: 14px;
      align-items: center;
    }

    .sidebar-avatar {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background: rgba(59, 130, 246, 0.18);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .sidebar-user-name {
      font-size: 15px;
      font-weight: 500;
      color: #e2e8f0;
    }

    .sidebar-user-company {
      font-size: 13px;
      color: rgba(226, 232, 240, 0.7);
      margin-top: 2px;
    }

    .sidebar-nav {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid transparent;
      background: transparent;
      color: rgba(226, 232, 240, 0.75);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .nav-link:hover {
      border-color: rgba(148, 163, 184, 0.25);
      background: rgba(148, 163, 184, 0.08);
      color: #fff;
    }

    .nav-link.active {
      background: rgba(59, 130, 246, 0.15);
      color: #fff;
      border-color: rgba(148, 163, 184, 0.35);
      box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);
    }

    .nav-icon {
      font-size: 18px;
      width: 20px;
      text-align: center;
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 13px;
      color: rgba(226, 232, 240, 0.6);
      display: grid;
      gap: 6px;
    }

    .sidebar-footer a {
      color: #bfdbfe;
      font-weight: 500;
    }

    .content-area {
      background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.98) 100%);
      padding: 36px 48px;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      gap: 24px;
      align-items: center;
      margin-bottom: 32px;
    }

    .breadcrumb {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-subtle);
      margin-bottom: 8px;
    }

    .welcome-heading {
      font-size: 28px;
      font-weight: 500;
      color: var(--text-strong);
    }

    .content-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .support-btn,
    .logout-btn {
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 500;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-subtle);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .support-btn:hover {
      border-color: rgba(37, 99, 235, 0.4);
      color: var(--primary);
      background: var(--primary-soft);
    }

    .logout-btn {
      background: var(--text-strong);
      color: #fff;
      border: none;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.15);
    }

    .logout-btn:hover {
      transform: translateY(-1px);
      background: #0b1529;
    }

    .content-scroll {
      display: grid;
      gap: 32px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
    }

    .stat-card {
      background: var(--surface);
      border-radius: var(--radius-md);
      padding: 20px;
      border: 1px solid rgba(226, 232, 240, 0.6);
      box-shadow: 0 10px 35px rgba(15, 23, 42, 0.06);
      display: grid;
      gap: 12px;
    }

    .stat-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--primary-soft);
      color: var(--primary);
      font-size: 20px;
    }

    .stat-label {
      font-size: 12px;
      font-weight: 500;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-subtle);
    }

    .stat-value {
      font-size: 26px;
      font-weight: 500;
      color: var(--text-strong);
    }

    .panel-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
    }

    .panel {
      background: var(--surface);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(226, 232, 240, 0.6);
      box-shadow: var(--shadow-soft);
      padding: 24px;
      display: grid;
      gap: 18px;
    }

    .panel.span-2 {
      grid-column: span 2;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .panel-title {
      font-size: 18px;
      font-weight: 500;
      color: var(--text-strong);
    }

    .panel-subtitle {
      font-size: 13px;
      color: var(--text-subtle);
    }

    .panel-action {
      font-size: 13px;
      color: var(--primary);
      font-weight: 500;
    }

    .panel-body {
      display: grid;
      gap: 16px;
    }

    .timeline {
      position: relative;
      padding-left: 24px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 6px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: rgba(226, 232, 240, 0.8);
    }

    .timeline-item {
      position: relative;
      padding-bottom: 18px;
      display: grid;
      gap: 6px;
    }

    .timeline-item:last-child {
      padding-bottom: 0;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -20px;
      top: 6px;
      width: 10px;
      height: 10px;
      background: var(--primary);
      border-radius: 50%;
      border: 2px solid #fff;
      box-shadow: 0 0 0 4px var(--primary-soft);
    }

    .update-date {
      font-size: 12px;
      color: var(--text-subtle);
      letter-spacing: 0.02em;
    }

    .update-title {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-strong);
    }

    .update-content {
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.6;
    }

    .update-project {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--primary);
      background: var(--primary-soft);
      font-weight: 500;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 24px;
    }

    .project-card {
      background: var(--surface);
      border-radius: var(--radius-md);
      border: 1px solid rgba(226, 232, 240, 0.7);
      padding: 24px;
      display: grid;
      gap: 16px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .project-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-soft);
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
    }

    .project-title {
      font-size: 17px;
      font-weight: 500;
      color: var(--text-strong);
      margin-bottom: 6px;
    }

    .project-date {
      font-size: 13px;
      color: var(--text-subtle);
    }

    .project-description {
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.65;
    }

    .project-footer {
      border-top: 1px solid rgba(226, 232, 240, 0.7);
      padding-top: 16px;
    }

    .progress-label {
      font-size: 13px;
      color: var(--text-subtle);
      margin-bottom: 8px;
    }

    .progress-bar {
      height: 8px;
      background: rgba(226, 232, 240, 0.8);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6 0%, #6366f1 100%);
      border-radius: 999px;
      transition: width 0.3s ease;
    }

    .task-list {
      background: var(--surface);
      border-radius: var(--radius-md);
      border: 1px solid rgba(226, 232, 240, 0.7);
      padding: 24px;
      display: grid;
      gap: 18px;
      box-shadow: var(--shadow-soft);
    }

    .task-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(226, 232, 240, 0.6);
    }

    .task-item:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    .task-title {
      font-size: 14px;
      color: var(--text-strong);
      font-weight: 500;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 500;
      text-transform: capitalize;
    }

    .status-badge.planning { background: #fef3c7; color: #b45309; }
    .status-badge.in_progress { background: #dbeafe; color: #2563eb; }
    .status-badge.completed,
    .status-badge.done { background: #dcfce7; color: #15803d; }
    .status-badge.todo { background: #f8fafc; color: #64748b; }
    .status-badge.high { background: #fee2e2; color: #dc2626; }
    .status-badge.medium { background: #fef3c7; color: #b45309; }
    .status-badge.low { background: #f8fafc; color: #64748b; }

    .empty-state {
      padding: 48px 24px;
      background: #fff;
      border-radius: var(--radius-md);
      border: 1px dashed rgba(148, 163, 184, 0.5);
      text-align: center;
      display: grid;
      gap: 8px;
      color: var(--text-subtle);
    }

    .empty-icon { font-size: 32px; }
    .empty-title { font-weight: 500; color: var(--text-strong); }
    .empty-text { font-size: 14px; }

    .section-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 20px;
    }

    .section-header p {
      color: var(--text-subtle);
      font-size: 14px;
    }

    .files-grid,
    .billing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
    }

    .file-card,
    .billing-card {
      background: var(--surface);
      padding: 20px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(226, 232, 240, 0.7);
      box-shadow: 0 12px 32px rgba(15, 23, 42, 0.08);
      display: grid;
      gap: 12px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--primary-soft);
      color: var(--primary);
      border-radius: 999px;
      font-size: 12px;
      font-weight: 500;
    }

    @media (max-width: 1100px) {
      .dashboard-shell {
        grid-template-columns: 240px minmax(0, 1fr);
      }
    }

    @media (max-width: 900px) {
      .dashboard-shell {
        grid-template-columns: 1fr;
      }

      .sidebar {
        position: relative;
        height: auto;
        flex-direction: row;
        align-items: center;
        gap: 16px;
        padding: 20px;
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.25);
        overflow-x: auto;
      }

      .sidebar-brand,
      .sidebar-footer {
        display: none;
      }

      .sidebar-user-card {
        padding: 12px;
      }

      .sidebar-nav {
        flex-direction: row;
        gap: 8px;
      }

      .nav-link {
        padding: 10px 14px;
        border-radius: 10px;
        white-space: nowrap;
      }

      .content-area {
        padding: 28px 20px 48px;
      }

      .content-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .content-actions {
        width: 100%;
        justify-content: flex-start;
        flex-wrap: wrap;
      }

      .panel-grid {
        grid-template-columns: 1fr;
      }

      .panel.span-2 {
        grid-column: span 1;
      }
    }

    @media (max-width: 560px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }

      .projects-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="dashboard-shell">
    <aside class="sidebar">
      <div class="sidebar-brand">
        <div class="brand-logo">IM</div>
        <div>
          <div class="brand-name">imisofts</div>
          <div class="brand-tagline">client workspace</div>
        </div>
      </div>

      <div class="sidebar-user-card">
        <div class="sidebar-avatar" id="userAvatar">C</div>
        <div>
          <div class="sidebar-user-name" id="userName">Client User</div>
          <div class="sidebar-user-company" id="userCompany">TechCorp</div>
        </div>
      </div>

      <nav class="sidebar-nav">
        <button class="nav-link active" data-section="overview"><span class="nav-icon">üè†</span>Overview</button>
        <button class="nav-link" data-section="projects"><span class="nav-icon">üì¶</span>Projects</button>
        <button class="nav-link" data-section="updates"><span class="nav-icon">üóûÔ∏è</span>Updates</button>
        <button class="nav-link" data-section="tasks"><span class="nav-icon">‚úÖ</span>Tasks</button>
        <button class="nav-link" data-section="files"><span class="nav-icon">üìÅ</span>Files</button>
        <button class="nav-link" data-section="billing"><span class="nav-icon">üí≥</span>Billing</button>
      </nav>

      <div class="sidebar-footer">
        <span>Need urgent assistance?</span>
        <a href="mailto:growth@imisofts.com">growth@imisofts.com</a>
      </div>
    </aside>

    <div class="content-area">
      <header class="content-header">
        <div>
          <p class="breadcrumb">Client Portal</p>
          <h1 class="welcome-heading" id="welcomeTitle">Welcome back!</h1>
        </div>
        <div class="content-actions">
          <button class="support-btn">Visit Support Center</button>
          <button class="logout-btn" onclick="logout()">Sign Out</button>
        </div>
      </header>

      <div class="content-scroll">
        <section id="overview" class="content-section active">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">üìä</div>
              <span class="stat-label">Active Projects</span>
              <span class="stat-value" id="activeProjects">0</span>
            </div>
            <div class="stat-card">
              <div class="stat-icon">‚úÖ</div>
              <span class="stat-label">Tasks Completed</span>
              <span class="stat-value" id="completedTasks">0</span>
            </div>
            <div class="stat-card">
              <div class="stat-icon">‚è≥</div>
              <span class="stat-label">In Progress</span>
              <span class="stat-value" id="inProgressTasks">0</span>
            </div>
            <div class="stat-card">
              <div class="stat-icon">üóûÔ∏è</div>
              <span class="stat-label">Recent Updates</span>
              <span class="stat-value" id="recentUpdates">0</span>
            </div>
          </div>

          <div class="panel-grid">
            <article class="panel span-2">
              <div class="panel-header">
                <div>
                  <h2 class="panel-title">Recent Activity</h2>
                  <p class="panel-subtitle">Latest notes from the imisofts delivery team</p>
                </div>
              </div>
              <div class="panel-body" id="recentActivity"></div>
            </article>

            <article class="panel">
              <div class="panel-header">
                <div>
                  <h2 class="panel-title">Upcoming Check-ins</h2>
                  <p class="panel-subtitle">What to expect this week</p>
                </div>
              </div>
              <div class="panel-body">
                <div>
                  <span class="chip">Wednesday ¬∑ 3:00 PM GST</span>
                  <p class="panel-subtitle">Weekly growth sync with delivery lead</p>
                </div>
                <div>
                  <span class="chip">Friday ¬∑ 11:00 AM GST</span>
                  <p class="panel-subtitle">Campaign performance review &amp; next steps</p>
                </div>
              </div>
            </article>

            <article class="panel">
              <div class="panel-header">
                <div>
                  <h2 class="panel-title">Key Contacts</h2>
                  <p class="panel-subtitle">Who is owning what on our side</p>
                </div>
              </div>
              <div class="panel-body">
                <div>
                  <strong>Delivery Lead</strong>
                  <p class="panel-subtitle">Maya Khan ¬∑ growth@imisofts.com</p>
                </div>
                <div>
                  <strong>Growth Strategist</strong>
                  <p class="panel-subtitle">Omar Haddad ¬∑ growth@imisofts.com</p>
                </div>
                <div>
                  <strong>Support Desk</strong>
                  <p class="panel-subtitle">growth@imisofts.com</p>
                </div>
              </div>
            </article>
          </div>
        </section>

        <section id="projects" class="content-section">
          <div class="section-header">
            <h2 class="panel-title">Projects in Motion</h2>
            <p>Every deliverable and build currently shipping for your team.</p>
          </div>
          <div id="projectsList"></div>
        </section>

        <section id="updates" class="content-section">
          <div class="section-header">
            <h2 class="panel-title">Detailed Updates</h2>
            <p>Milestones, blockers, and hand-offs logged by the delivery team.</p>
          </div>
          <div class="panel">
            <div class="panel-body" id="updatesList"></div>
          </div>
        </section>

        <section id="tasks" class="content-section">
          <div class="section-header">
            <h2 class="panel-title">Task Progress</h2>
            <p>Track the granular work happening across each project.</p>
          </div>
          <div id="tasksList"></div>
        </section>

        <section id="files" class="content-section">
          <div class="section-header">
            <h2 class="panel-title">Shared Assets</h2>
            <p>Campaign copy, creative, and resources delivered to date.</p>
          </div>
          <div class="files-grid">
            <div class="file-card">
              <span class="chip">Latest Upload</span>
              <strong>Onboarding Kit</strong>
              <p class="panel-subtitle">Welcome guide, launch checklist, and escalation paths.</p>
              <a href="#" class="panel-action">Download</a>
            </div>
            <div class="file-card">
              <span class="chip">Template</span>
              <strong>Cold Email Sequence v2</strong>
              <p class="panel-subtitle">Approved copy set for ICP #1 including follow-ups.</p>
              <a href="#" class="panel-action">View in Notion</a>
            </div>
            <div class="file-card">
              <span class="chip">Reference</span>
              <strong>Reporting Dashboard</strong>
              <p class="panel-subtitle">Live campaign performance tracked in Data Studio.</p>
              <a href="#" class="panel-action">Open dashboard</a>
            </div>
          </div>
        </section>

        <section id="billing" class="content-section">
          <div class="section-header">
            <h2 class="panel-title">Billing &amp; Invoices</h2>
            <p>Your subscriptions, invoices, and upcoming renewals.</p>
          </div>
          <div class="billing-grid">
            <div class="billing-card">
              <span class="chip">Current Plan</span>
              <strong>Growth Retainer ¬∑ $4,800/mo</strong>
              <p class="panel-subtitle">Next renewal on July 28 ¬∑ Payment method ending ‚Ä¢‚Ä¢34</p>
              <a href="#" class="panel-action">Manage subscription ‚Üí</a>
            </div>
            <div class="billing-card">
              <span class="chip">Latest Invoice</span>
              <strong>Invoice #INV-1092</strong>
              <p class="panel-subtitle">Issued June 28 ¬∑ Paid ¬∑ Receipt emailed to finance@techcorp.com</p>
              <a href="#" class="panel-action">Download PDF</a>
            </div>
            <div class="billing-card">
              <span class="chip">Add-ons</span>
              <strong>Domain Infrastructure</strong>
              <p class="panel-subtitle">Billed annually ¬∑ Next review September 1</p>
              <a href="#" class="panel-action">View agreement</a>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    const currentUser = JSON.parse(sessionStorage.getItem('currentUser') || 'null');
    if (!currentUser || currentUser.role !== 'client') {
      window.location.href = 'client-login.html';
    }

    const companies = JSON.parse(localStorage.getItem('companies') || '[]');
    const userCompany = companies.find(c => c.id === currentUser.companyId);

    document.getElementById('userName').textContent = currentUser.fullName;
    document.getElementById('userAvatar').textContent = currentUser.fullName.charAt(0).toUpperCase();
    document.getElementById('userCompany').textContent = userCompany ? userCompany.name : 'Your Company';
    document.getElementById('welcomeTitle').textContent = `Welcome back, ${currentUser.fullName}!`;

    const navLinks = document.querySelectorAll('.nav-link');

    function showSection(section) {
      navLinks.forEach(link => {
        link.classList.toggle('active', link.dataset.section === section);
      });

      document.querySelectorAll('.content-section').forEach(sec => {
        sec.classList.toggle('active', sec.id === section);
      });

      if (section === 'overview') loadDashboardData();
      if (section === 'projects') loadProjects();
      if (section === 'updates') loadUpdates();
      if (section === 'tasks') loadTasks();
    }

    navLinks.forEach(link => {
      link.addEventListener('click', () => showSection(link.dataset.section));
    });

    function loadDashboardData() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
      const updates = JSON.parse(localStorage.getItem('updates') || '[]');

      const companyProjects = projects.filter(p => p.companyId === currentUser.companyId);
      const projectIds = companyProjects.map(p => p.id);
      const companyTasks = tasks.filter(t => projectIds.includes(t.projectId));
      const companyUpdates = updates.filter(u => projectIds.includes(u.projectId) && u.isClientVisible);

      document.getElementById('activeProjects').textContent = companyProjects.filter(p => p.status === 'in_progress').length;
      document.getElementById('completedTasks').textContent = companyTasks.filter(t => t.status === 'done').length;
      document.getElementById('inProgressTasks').textContent = companyTasks.filter(t => t.status === 'in_progress').length;
      document.getElementById('recentUpdates').textContent = companyUpdates.length;

      if (companyUpdates.length > 0) {
        const activityHtml = `
          <div class="timeline">
            ${companyUpdates.slice(0, 5).map(update => {
              const project = companyProjects.find(p => p.id === update.projectId);
              return `
                <div class="timeline-item">
                  <div class="update-date">${new Date(update.createdAt).toLocaleDateString()}</div>
                  <div class="update-title">${update.title}</div>
                  <div class="update-content">${update.content}</div>
                  <span class="update-project">${project ? project.name : 'Project'}</span>
                </div>
              `;
            }).join('')}
          </div>
        `;
        document.getElementById('recentActivity').innerHTML = activityHtml;
      } else {
        document.getElementById('recentActivity').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üóûÔ∏è</div>
            <div class="empty-title">No recent updates yet</div>
            <div class="empty-text">Updates from the delivery team will appear here.</div>
          </div>
        `;
      }
    }

    function loadProjects() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
      const companyProjects = projects.filter(p => p.companyId === currentUser.companyId);

      if (companyProjects.length > 0) {
        const projectsHtml = `
          <div class="projects-grid">
            ${companyProjects.map(project => {
              const projectTasks = tasks.filter(t => t.projectId === project.id);
              const completedTasks = projectTasks.filter(t => t.status === 'done').length;
              const progress = projectTasks.length > 0
                ? Math.round((completedTasks / projectTasks.length) * 100)
                : 0;

              return `
                <div class="project-card">
                  <div class="project-header">
                    <div>
                      <div class="project-title">${project.name}</div>
                      <div class="project-date">Started ${new Date(project.createdAt).toLocaleDateString()}</div>
                    </div>
                    <span class="status-badge ${project.status}">${project.status.replace('_', ' ')}</span>
                  </div>
                  <div class="project-description">
                    ${project.description || 'Project in progress. Updates will be posted regularly.'}
                  </div>
                  <div class="project-footer">
                    <div class="progress-label">Progress: ${progress}%</div>
                    <div class="progress-bar">
                      <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        `;
        document.getElementById('projectsList').innerHTML = projectsHtml;
      } else {
        document.getElementById('projectsList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üì¶</div>
            <div class="empty-title">No active projects yet</div>
            <div class="empty-text">Once a new project kicks off, you will see it here.</div>
          </div>
        `;
      }
    }

    function loadUpdates() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const updates = JSON.parse(localStorage.getItem('updates') || '[]');
      const companyProjects = projects.filter(p => p.companyId === currentUser.companyId);
      const projectIds = companyProjects.map(p => p.id);
      const companyUpdates = updates.filter(u => projectIds.includes(u.projectId) && u.isClientVisible);

      if (companyUpdates.length > 0) {
        const updatesHtml = `
          <div class="timeline">
            ${companyUpdates.map(update => {
              const project = companyProjects.find(p => p.id === update.projectId);
              return `
                <div class="timeline-item">
                  <div class="update-date">${new Date(update.createdAt).toLocaleString()}</div>
                  <div class="update-title">${update.title}</div>
                  <div class="update-content">${update.content}</div>
                  <span class="update-project">${project ? project.name : 'Project'}</span>
                </div>
              `;
            }).join('')}
          </div>
        `;
        document.getElementById('updatesList').innerHTML = updatesHtml;
      } else {
        document.getElementById('updatesList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üì¢</div>
            <div class="empty-title">No updates available</div>
            <div class="empty-text">Project updates will appear here as soon as they are published.</div>
          </div>
        `;
      }
    }

    function loadTasks() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
      const companyProjects = projects.filter(p => p.companyId === currentUser.companyId);

      if (companyProjects.length > 0) {
        let tasksHtml = '<div class="panel-grid">';

        companyProjects.forEach(project => {
          const projectTasks = tasks.filter(t => t.projectId === project.id);

          if (projectTasks.length > 0) {
            const completedTasks = projectTasks.filter(t => t.status === 'done').length;
            const progressPercent = Math.round((completedTasks / projectTasks.length) * 100);

            tasksHtml += `
              <div class="task-list">
                <div class="panel-header" style="gap: 4px;">
                  <div>
                    <h3 class="panel-title" style="font-size: 16px;">${project.name}</h3>
                    <p class="panel-subtitle">${completedTasks}/${projectTasks.length} tasks complete</p>
                  </div>
                </div>
                <div>
                  <div class="progress-label">Progress: ${progressPercent}%</div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progressPercent}%"></div>
                  </div>
                </div>
                ${projectTasks.map(task => `
                  <div class="task-item">
                    <span class="task-title">${task.title}</span>
                    <div style="display: flex; gap: 8px;">
                      <span class="status-badge ${task.priority}">${task.priority}</span>
                      <span class="status-badge ${task.status}">${task.status.replace('_', ' ')}</span>
                    </div>
                  </div>
                `).join('')}
              </div>
            `;
          }
        });

        tasksHtml += '</div>';
        document.getElementById('tasksList').innerHTML = tasksHtml;
      } else {
        document.getElementById('tasksList').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">‚úÖ</div>
            <div class="empty-title">No tasks to review</div>
            <div class="empty-text">Once delivery starts, individual tasks will be tracked here.</div>
          </div>
        `;
      }
    }

    function logout() {
      sessionStorage.removeItem('currentUser');
      window.location.href = 'client-login.html';
    }

    loadDashboardData();
    showSection('overview');
  </script>
  <!-- Cal floating-popup embed code begins -->
  <script type="text/javascript">
    (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
  Cal("init", "30min", {origin:"https://app.cal.com"});

  Cal.ns["30min"]("floatingButton", {"calLink":"zeeshanwaheed/30min","config":{"layout":"month_view","theme":"auto"},"buttonText":"Book Growth Call","hideButtonIcon":false}); 
  Cal.ns["30min"]("ui", {"hideEventTypeDetails":false,"layout":"month_view"});
  </script>
  <!-- Cal floating-popup embed code ends -->

</body>
</html>
